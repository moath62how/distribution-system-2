<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ุงุฎุชุจุงุฑ API ููุชุนุฏูู</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        .btn { 
            padding: 10px 20px; 
            margin: 5px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer;
            background: #007bff;
            color: white;
        }
        .btn:hover { background: #0056b3; }
        #results { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 5px; 
            margin-top: 10px;
            white-space: pre-wrap;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>ุงุฎุชุจุงุฑ API ููุชุนุฏูู</h1>
    
    <div class="test-section">
        <h2>ุงููุดููุฉ ุงููุจูุบ ุนููุง:</h2>
        <p class="error">โ ุงูุชุนุฏููุงุช ูุง ุชุธูุฑ ูู ูุดูู ุงูุญุณุงุจ ูุงูุชูุงุฑูุฑ</p>
        <p class="info">โน๏ธ ุงูููุฏุงู ููุชุญ ูููุบูู ุจุดูู ุตุญูุญุ ููู ุงูุจูุงูุงุช ูุง ุชูุญูุธ</p>
    </div>
    
    <div class="test-section">
        <h2>ุงุฎุชุจุงุฑ API ููุนููุงุก:</h2>
        <button class="btn" onclick="testUpdateClient()">ุงุฎุชุจุงุฑ ุชุญุฏูุซ ุนููู</button>
        <button class="btn" onclick="testGetClient()">ุงุฎุชุจุงุฑ ุฌูุจ ุจูุงูุงุช ุนููู</button>
    </div>
    
    <div class="test-section">
        <h2>ุงุฎุชุจุงุฑ API ููููุงูููู:</h2>
        <button class="btn" onclick="testUpdateContractor()">ุงุฎุชุจุงุฑ ุชุญุฏูุซ ููุงูู</button>
        <button class="btn" onclick="testGetContractor()">ุงุฎุชุจุงุฑ ุฌูุจ ุจูุงูุงุช ููุงูู</button>
    </div>
    
    <div class="test-section">
        <h2>ุงุฎุชุจุงุฑ API ูููุณุงุฑุงุช:</h2>
        <button class="btn" onclick="testUpdateCrusher()">ุงุฎุชุจุงุฑ ุชุญุฏูุซ ูุณุงุฑุฉ</button>
        <button class="btn" onclick="testGetCrusher()">ุงุฎุชุจุงุฑ ุฌูุจ ุจูุงูุงุช ูุณุงุฑุฉ</button>
    </div>
    
    <div class="test-section">
        <h2>ุงููุชุงุฆุฌ:</h2>
        <div id="results">ุงููุฑ ุนูู ุฃู ุฒุฑ ุฃุนูุงู ูุจุฏุก ุงูุงุฎุชุจุงุฑ...</div>
    </div>
    
    <div class="test-section">
        <h2>ุงูุญููู ุงููุญุชููุฉ:</h2>
        <ul>
            <li class="info">ุชุญูู ูู ุฃู ุงูุณูุฑูุฑ ูุนูู ุนูู ุงููููุฐ ุงูุตุญูุญ</li>
            <li class="info">ุชุญูู ูู ุฃู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชุตูุฉ</li>
            <li class="info">ุชุญูู ูู console ููุฃุฎุทุงุก</li>
            <li class="info">ุชุญูู ูู Network tab ูู Developer Tools</li>
        </ul>
    </div>

    <script>
        const API_BASE = (function () {
            try {
                const origin = window.location.origin;
                if (!origin || origin === 'null') return 'http://localhost:5000/api';
                return origin.replace(/\/$/, '') + '/api';
            } catch (e) {
                return 'http://localhost:5000/api';
            }
        })();
        
        function log(message) {
            const results = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString();
            results.textContent += `[${timestamp}] ${message}\n`;
            console.log(message);
        }
        
        function clearLog() {
            document.getElementById('results').textContent = '';
        }
        
        async function testUpdateClient() {
            clearLog();
            log('๐งช ุงุฎุชุจุงุฑ ุชุญุฏูุซ ุงูุนููู...');
            log(`API Base: ${API_BASE}`);
            
            const clientId = 1; // ุงูุชุฑุงุถ ุฃู ุงูุนููู ุฑูู 1 ููุฌูุฏ
            const testData = {
                name: 'ุนููู ุชุฌุฑูุจู - ' + new Date().getTime(),
                phone: '01234567890',
                opening_balance: 1500
            };
            
            try {
                log(`๐ค ุฅุฑุณุงู PUT ุฅูู: ${API_BASE}/clients/${clientId}`);
                log(`๐ฆ ุงูุจูุงูุงุช: ${JSON.stringify(testData, null, 2)}`);
                
                const response = await fetch(`${API_BASE}/clients/${clientId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(testData)
                });
                
                log(`๐ฅ ุงุณุชุฌุงุจุฉ HTTP: ${response.status} ${response.statusText}`);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    log(`โ ุฎุทุฃ ูู ุงูุงุณุชุฌุงุจุฉ: ${errorText}`);
                    return;
                }
                
                const result = await response.json();
                log(`โ ูุฌุญ ุงูุชุญุฏูุซ!`);
                log(`๐ ุงูุจูุงูุงุช ุงููุญุฏุซุฉ: ${JSON.stringify(result, null, 2)}`);
                
            } catch (error) {
                log(`โ ุฎุทุฃ ูู ุงูุดุจูุฉ: ${error.message}`);
                log(`๐ ุชูุงุตูู ุงูุฎุทุฃ: ${error.stack}`);
            }
        }
        
        async function testGetClient() {
            clearLog();
            log('๐งช ุงุฎุชุจุงุฑ ุฌูุจ ุจูุงูุงุช ุงูุนููู...');
            
            const clientId = 1;
            
            try {
                log(`๐ค ุฅุฑุณุงู GET ุฅูู: ${API_BASE}/clients/${clientId}`);
                
                const response = await fetch(`${API_BASE}/clients/${clientId}`);
                
                log(`๐ฅ ุงุณุชุฌุงุจุฉ HTTP: ${response.status} ${response.statusText}`);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    log(`โ ุฎุทุฃ ูู ุงูุงุณุชุฌุงุจุฉ: ${errorText}`);
                    return;
                }
                
                const result = await response.json();
                log(`โ ูุฌุญ ุฌูุจ ุงูุจูุงูุงุช!`);
                log(`๐ ุจูุงูุงุช ุงูุนููู: ${JSON.stringify(result, null, 2)}`);
                
            } catch (error) {
                log(`โ ุฎุทุฃ ูู ุงูุดุจูุฉ: ${error.message}`);
            }
        }
        
        async function testUpdateContractor() {
            clearLog();
            log('๐งช ุงุฎุชุจุงุฑ ุชุญุฏูุซ ุงูููุงูู...');
            
            const contractorId = 1;
            const testData = {
                name: 'ููุงูู ุชุฌุฑูุจู - ' + new Date().getTime(),
                opening_balance: 2000
            };
            
            try {
                log(`๐ค ุฅุฑุณุงู PUT ุฅูู: ${API_BASE}/contractors/${contractorId}`);
                log(`๐ฆ ุงูุจูุงูุงุช: ${JSON.stringify(testData, null, 2)}`);
                
                const response = await fetch(`${API_BASE}/contractors/${contractorId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(testData)
                });
                
                log(`๐ฅ ุงุณุชุฌุงุจุฉ HTTP: ${response.status} ${response.statusText}`);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    log(`โ ุฎุทุฃ ูู ุงูุงุณุชุฌุงุจุฉ: ${errorText}`);
                    return;
                }
                
                const result = await response.json();
                log(`โ ูุฌุญ ุงูุชุญุฏูุซ!`);
                log(`๐ ุงูุจูุงูุงุช ุงููุญุฏุซุฉ: ${JSON.stringify(result, null, 2)}`);
                
            } catch (error) {
                log(`โ ุฎุทุฃ ูู ุงูุดุจูุฉ: ${error.message}`);
            }
        }
        
        async function testGetContractor() {
            clearLog();
            log('๐งช ุงุฎุชุจุงุฑ ุฌูุจ ุจูุงูุงุช ุงูููุงูู...');
            
            const contractorId = 1;
            
            try {
                log(`๐ค ุฅุฑุณุงู GET ุฅูู: ${API_BASE}/contractors/${contractorId}`);
                
                const response = await fetch(`${API_BASE}/contractors/${contractorId}`);
                
                log(`๐ฅ ุงุณุชุฌุงุจุฉ HTTP: ${response.status} ${response.statusText}`);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    log(`โ ุฎุทุฃ ูู ุงูุงุณุชุฌุงุจุฉ: ${errorText}`);
                    return;
                }
                
                const result = await response.json();
                log(`โ ูุฌุญ ุฌูุจ ุงูุจูุงูุงุช!`);
                log(`๐ ุจูุงูุงุช ุงูููุงูู: ${JSON.stringify(result, null, 2)}`);
                
            } catch (error) {
                log(`โ ุฎุทุฃ ูู ุงูุดุจูุฉ: ${error.message}`);
            }
        }
        
        async function testUpdateCrusher() {
            clearLog();
            log('๐งช ุงุฎุชุจุงุฑ ุชุญุฏูุซ ุงููุณุงุฑุฉ...');
            
            const crusherId = 1;
            const testData = {
                name: 'ูุณุงุฑุฉ ุชุฌุฑูุจูุฉ - ' + new Date().getTime()
            };
            
            try {
                log(`๐ค ุฅุฑุณุงู PUT ุฅูู: ${API_BASE}/crushers/${crusherId}`);
                log(`๐ฆ ุงูุจูุงูุงุช: ${JSON.stringify(testData, null, 2)}`);
                
                const response = await fetch(`${API_BASE}/crushers/${crusherId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(testData)
                });
                
                log(`๐ฅ ุงุณุชุฌุงุจุฉ HTTP: ${response.status} ${response.statusText}`);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    log(`โ ุฎุทุฃ ูู ุงูุงุณุชุฌุงุจุฉ: ${errorText}`);
                    return;
                }
                
                const result = await response.json();
                log(`โ ูุฌุญ ุงูุชุญุฏูุซ!`);
                log(`๐ ุงูุจูุงูุงุช ุงููุญุฏุซุฉ: ${JSON.stringify(result, null, 2)}`);
                
            } catch (error) {
                log(`โ ุฎุทุฃ ูู ุงูุดุจูุฉ: ${error.message}`);
            }
        }
        
        async function testGetCrusher() {
            clearLog();
            log('๐งช ุงุฎุชุจุงุฑ ุฌูุจ ุจูุงูุงุช ุงููุณุงุฑุฉ...');
            
            const crusherId = 1;
            
            try {
                log(`๐ค ุฅุฑุณุงู GET ุฅูู: ${API_BASE}/crushers/${crusherId}`);
                
                const response = await fetch(`${API_BASE}/crushers/${crusherId}`);
                
                log(`๐ฅ ุงุณุชุฌุงุจุฉ HTTP: ${response.status} ${response.statusText}`);
                
                if (!response.ok) {
                    const errorText = await response.text();
                    log(`โ ุฎุทุฃ ูู ุงูุงุณุชุฌุงุจุฉ: ${errorText}`);
                    return;
                }
                
                const result = await response.json();
                log(`โ ูุฌุญ ุฌูุจ ุงูุจูุงูุงุช!`);
                log(`๐ ุจูุงูุงุช ุงููุณุงุฑุฉ: ${JSON.stringify(result, null, 2)}`);
                
            } catch (error) {
                log(`โ ุฎุทุฃ ูู ุงูุดุจูุฉ: ${error.message}`);
            }
        }
        
        // Test on page load
        window.addEventListener('load', () => {
            log('๐ ุตูุญุฉ ุงูุงุฎุชุจุงุฑ ุฌุงูุฒุฉ');
            log(`๐ API Base URL: ${API_BASE}`);
            log('๐ก ุงููุฑ ุนูู ุงูุฃุฒุฑุงุฑ ุฃุนูุงู ูุงุฎุชุจุงุฑ API');
        });
    </script>
</body>
</html>